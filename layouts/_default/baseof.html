<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">

  {{/* Allow the livereload.js script's functionality iff we're running in server mode */}}
  {{ $s := "" }}
  {{ if site.IsServer }}
  {{ $s = "script-src 'self' 'sha512-gOV/VHal2490Lqs5m9ZH4DB3brwtQNYj6MqAIyPzjZfwZiKrjkfm1dgJEzj5M3VERytWjm3ZLMg11nCJtWWwdg=='; connect-src 'self';" }}
  {{ end }}
  <meta http-equiv="Content-Security-Policy" content="default-src 'none'; img-src 'self'; style-src 'self'; {{ $s }} block-all-mixed-content; require-sri-for script style; frame-ancestors 'none'; base-uri 'none'; form-action 'none';">

  <title>
    {{ block "title" . }}
      {{ .Title }}
    {{ end }}
  </title>
  <meta name="description" content="{{ .Page.Title }}">
  <meta name="author" content="{{ site.Author.name }}">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="shortcut icon"
          {{ if site.Params.faviconfile }}
            href="{{ site.Params.faviconfile | absURL }}"
          {{ else }}
            href="{{ site.BaseURL }}img/favicon.ico"
          {{ end }}
        type="image/x-icon">

  {{ $cssResources := resources.Match "css/*.css" }}

  {{/* Don't optimize the CSS for local development */}}
  {{ if site.IsServer }}
    {{ range $cssResources }}
      <link href="{{ .Permalink }}" rel="stylesheet" type="text/css"/>
    {{ end }}
  {{ else }}
    {{ $css := resources.Concat "css/styles.css" $cssResources | resources.Minify | resources.Fingerprint }}
    <link href="{{ $css.Permalink }}" integrity="{{ $css.Data.Integrity }}" rel="stylesheet" type="text/css"/>
  {{ end }}

  {{ with .OutputFormats.Get "RSS" }}
    <link href="{{ .Permalink }}" rel="alternate" type="application/rss+xml" title="{{ site.Title }}"/>
  {{ end }}

  {{ hugo.Generator }}
</head>
<body>

{{/* Navbar never changes, so cache it unconditionally. */}}
{{ partialCached "navbar.html" . }}
<main class="main">
  {{ block "main" . }}
  {{ end }}
</main>

{{/* Footer never changes, so cache it unconditionally. */}}
{{ partialCached "footer.html" . }}

</body>
</html>
